# 2023-Publication_Coordinate-Regression-Tracking
<p style="margin-top:0pt; margin-bottom:8pt; text-align:justify;">With a growing geriatric population estimated to triple by 2050, minimally invasive<span dir="rtl">&nbsp;</span><span dir="ltr">procedures that are image-guided are becoming both more popular and necessary for treating a</span><span dir="rtl">&nbsp;</span><span dir="ltr">variety of diseases. To lower the learning curve for new procedures, it is necessary to develop</span><span dir="rtl">&nbsp;</span><span dir="ltr">better guidance systems and methods to analyze procedure performance. Since fluoroscopy</span><span dir="rtl">&nbsp;</span><span dir="ltr">remains the primary mode of visualizations, the ability to perform catheter tracking from</span><span dir="rtl">&nbsp;</span><span dir="ltr">fluoroscopic images is an important part of this endeavor. This paper explores the use of deep</span><span dir="rtl">&nbsp;</span><span dir="ltr">learning to perform landmark detection of a catheter from fluoroscopic images in 3D print heart</span><span dir="rtl">&nbsp;</span><span dir="ltr">models. We show that a two-stage deep convolutional neural network based model architecture</span><span dir="rtl">&nbsp;</span><span dir="ltr">can provide improved performance by initially locating a region of interest before determining</span><span dir="rtl">&nbsp;</span><span dir="ltr">the coordinates of the catheter tip within the image. This model has an average error of less</span><span dir="rtl">&nbsp;</span><span dir="ltr">than</span><span dir="rtl">&nbsp;</span><span dir="ltr">2% of the image resolution and can be performed within 4 milliseconds, allowing for the</span><span dir="rtl">&nbsp;</span><span dir="ltr">potential use for real-time intraprocedural tracking. Coordinate regression models have the</span><span dir="rtl">&nbsp;</span><span dir="ltr">advantage of directly outputting values that can be used for quantitative tracking in future</span><span dir="rtl">&nbsp;</span><span dir="ltr">applications and are easier to create groundtruth values (~50x faster), as compared to semantic</span><span dir="rtl">&nbsp;</span><span dir="ltr">segmentation models that require entire masks to be made. Therefore, we believe this work has a</span><span dir="rtl">&nbsp;</span><span dir="ltr">better long term potential to be used for a broader class of cardiac devices, catheters, and</span><span dir="rtl">&nbsp;</span><span dir="ltr">guidewires.</span></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:24pt; background-color:#ffffff;"><strong><span style="font-family:Arial; color:#222222;">Instructions</span></strong></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:18pt; background-color:#ffffff;"><strong><span style="font-family:Arial; color:#222222;">Requirements</span></strong></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:12pt; background-color:#ffffff;"><span style="font-family:Arial; color:#222222;">This code was tested on:</span></p>
<ul style="margin:0pt; padding-left:0pt;" type="disc">
    <li style="margin-top:14pt; margin-left:47.25pt; text-indent:-18pt; line-height:normal; font-family:serif; font-size:10pt; color:#222222; background-color:#ffffff; list-style-position:inside;"><span style="font-family:Arial; font-size:12pt;">python 3.8.10</span></li>
    <li style="margin-left:47.25pt; text-indent:-18pt; line-height:normal; font-family:serif; font-size:10pt; color:#222222; background-color:#ffffff; list-style-position:inside;"><span style="font-family:Arial; font-size:12pt;">numpy 1.21.6</span></li>
    <li style="margin-left:47.25pt; margin-bottom:14pt; text-indent:-18pt; line-height:normal; font-family:serif; font-size:10pt; color:#222222; background-color:#ffffff; list-style-position:inside;"><span style="font-family:Arial; font-size:12pt;">pandas 1.3.5</span></li>
</ul>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:18pt; background-color:#ffffff;"><strong><span style="font-family:Arial; color:#222222;">Dual Network</span></strong></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:12pt; background-color:#ffffff;"><span style="font-family:Arial; color:#222222;">The dual network model is located in</span><span style="font-family:Arial; color:#222222;">&nbsp;</span><span style="font-family:'Courier New'; font-size:10pt; color:#222222;">Final Version of VGG_model.ipynb</span><span style="font-family:Arial; color:#222222;">. This file imports required libraries and functions located in&nbsp;</span><span style="font-family:'Courier New'; font-size:10pt; color:#222222;">FinalUtils.py</span><span dir="rtl" style="font-family:'Courier New'; font-size:10pt; color:#222222;">.</span></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:12pt; background-color:#ffffff;"><span style="font-family:Arial; color:#222222;">To use the dual network in your own data, the first box of code with your own data address.</span></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:18pt; background-color:#ffffff;"><strong><span style="font-family:Arial; color:#222222;">Data</span></strong></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:12pt; background-color:#ffffff;"><span style="font-family:Arial; color:#222222;">The input images and labels are located in&nbsp;</span><span style="font-family:'Courier New'; font-size:10pt; color:#222222;">Data</span><span style="font-family:Arial; color:#222222;">&nbsp;folder. Test, Train and Validaiton index should be produced every time with test_train_split or saved and used again.</span></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:18pt; background-color:#ffffff;"><strong><span style="font-family:Arial; color:#222222;">PreTrained models</span></strong></p>
<p style="margin-top:14pt; margin-bottom:14pt; line-height:normal; font-size:12pt; background-color:#ffffff;"><span style="font-family:Arial; color:#222222;">All pretrained models which include models that are trained for different number of regions are saved in&nbsp;</span><span style="font-family:'Courier New'; font-size:10pt; color:#222222;">Models</span><span style="font-family:Arial; color:#222222;">&nbsp;folder. You can ignore&nbsp;</span><span style="font-family:'Courier New'; font-size:10pt; color:#222222;">model.fit&nbsp;</span><span style="font-family:Arial; color:#222222;">and use pretrained model to predict the landmark position.</span></p>
<p style="margin-top:0pt; margin-bottom:8pt;">&nbsp;</p>
